// This file is automatically generated. Do not edit it directly.
import { createClient } from '@supabase/supabase-js';
import { env } from '@/lib/env';
import type { Database } from './types';

// Supabase ì—°ê²° ìƒíƒœ í™•ì¸
export const isSupabaseConfigured = () => {
    return env.SUPABASE_URL !== 'https://placeholder.supabase.co' &&
        env.SUPABASE_ANON_KEY !== 'placeholder-anon-key';
};

// Supabase í´ë¼ì´ì–¸íŠ¸ ì•ˆì „í•œ ì´ˆê¸°í™”
function createSupabaseClient() {
    try {
        if (!isSupabaseConfigured()) {
            console.warn('ğŸš§ Supabase: Using placeholder configuration');
            console.warn('ğŸ“‹ Database features disabled. To enable:');
            console.warn('   1. Go to Vercel Dashboard â†’ Settings â†’ Environment Variables');
            console.warn('   2. Add VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY');
            console.warn('   3. Redeploy the application');

            // ì•ˆì „í•œ ë”ë¯¸ í´ë¼ì´ì–¸íŠ¸ (ì—ëŸ¬ ë°œìƒ ì•ˆ í•¨)
            return createClient(
                'https://placeholder.supabase.co',
                'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBsYWNlaG9sZGVyIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDk3NzEyMDAsImV4cCI6MTk2NTM0NzIwMH0.fake-key',
                {
                    auth: {
                        persistSession: false,
                        autoRefreshToken: false,
                        detectSessionInUrl: false
                    },
                    realtime: { enabled: false }
                }
            );
        }

        console.log('âœ… Supabase: Connected successfully');
        return createClient<Database>(
            env.SUPABASE_URL,
            env.SUPABASE_ANON_KEY,
            {
                auth: {
                    persistSession: true,
                    storageKey: 'rin-korea-auth',
                    autoRefreshToken: true,
                    detectSessionInUrl: true
                },
                realtime: {
                    enabled: true,
                    params: {
                        eventsPerSecond: 2
                    }
                },
                global: {
                    headers: {
                        'x-my-custom-header': 'rin-korea-app'
                    }
                }
            }
        );
    } catch (error) {
        console.error('âŒ Supabase: Failed to create client:', error);

        // ìµœì¢… í´ë°± í´ë¼ì´ì–¸íŠ¸
        return createClient(
            'https://placeholder.supabase.co',
            'placeholder-key',
            {
                auth: {
                    persistSession: false,
                    autoRefreshToken: false,
                    detectSessionInUrl: false
                },
                realtime: { enabled: false }
            }
        );
    }
}

export const supabase = createSupabaseClient();

// ê°œë°œ í™˜ê²½ì—ì„œ ìƒíƒœ í‘œì‹œ
if (env.DEV) {
    console.log('ğŸ”§ Supabase Configuration Status:', {
        configured: isSupabaseConfigured(),
        url: isSupabaseConfigured() ? 'âœ… Configured' : 'âŒ Missing VITE_SUPABASE_URL',
        key: isSupabaseConfigured() ? 'âœ… Configured' : 'âŒ Missing VITE_SUPABASE_ANON_KEY'
    });
}
